---
import Layout from "@/layouts/Layout.astro"
import QueueDetailsNav from "@/components/queueDetailsNav";

// This tells Astro this is a server-side rendered route
export const prerender = false;

// Add this function to satisfy Astro's requirements for dynamic routes
export function getStaticPaths() {
  return [];
}

const { queue } = Astro.params;

// Fetch queue details from the API
let queueDetails = null;
let error = null;

try {
  const response = await fetch(`http://localhost:8081/api/v1/queue/${queue}`);
  if (!response.ok) {
    throw new Error(`Queue not found: ${queue}`);
  }

  queueDetails = await response.json();
} catch (err) {
  console.error("Error fetching queue:", err);
  error = err.message;
}
---

<Layout title="Queue Details | Houston" description="Queue Details" ogimage="https://houston.seline.so/og.png">
  <div class="container mx-auto pt-3">
    <QueueDetailsNav client:only="react" queueDetails={queueDetails} error={error}/>
  </div>
</Layout>
